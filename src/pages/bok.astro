---
import Layout from '@/layouts/Base.astro';
import HeroSection from '@/components/HeroSection.astro';
import PageSection from '@/components/PageSection.astro';
import Prose from '@/components/Prose.astro';
---

<Layout title="Håndbok" description="Kynds håndbok for ansatte">
  <HeroSection
    title="Kynds håndbok"
    preamble="Her kan du lese mer om oss og hvordan vi gjør ting. Det er bare å snoke i vei."
  />


  <!-- Mobile sticky navigation -->
  <nav class="mobile-nav" id="mobile-nav">
    <div class="mobile-nav-content">
      <button
        class="handbook-menu-toggle"
        id="handbook-menu-toggle"
        aria-label="Toggle handbook navigation menu"
        aria-expanded="false"
      >
        <span class="triangle-icon">▶</span>
      </button>
      <h3 class="nav-title" id="current-section">Innhold</h3>

      <!-- Dropdown menu -->
      <div class="handbook-dropdown" id="handbook-dropdown">
        <ul class="nav-menu" id="nav-menu">
          <li><a href="#om-kynd" data-section="Om Kynd">Om Kynd</a></li>
          <li><a href="#lønn-og-goder" data-section="Lønn og goder">Lønn og goder</a></li>
          <li><a href="#arbeidsforhold" data-section="Arbeidsforhold">Arbeidsforhold</a></li>
          <li>
            <a href="#ferie-og-permisjon" data-section="Ferie og permisjon">Ferie og permisjon</a>
          </li>
          <li>
            <a href="#kompetanseutvikling" data-section="Kompetanseutvikling">Kompetanseutvikling</a
            >
          </li>
          <li>
            <a href="#miljø-og-bærekraft" data-section="Miljø og bærekraft">Miljø og bærekraft</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="handbook-container">
    <!-- Desktop sidebar navigation -->
    <nav class="handbook-nav desktop-nav">
      <ul class="nav-menu">
        <li><a href="#om-kynd">Om Kynd</a></li>
        <li><a href="#lønn-og-goder">Lønn og goder</a></li>
        <li><a href="#arbeidsforhold">Arbeidsforhold</a></li>
        <li><a href="#ferie-og-permisjon">Ferie og permisjon</a></li>
        <li><a href="#kompetanseutvikling">Kompetanseutvikling</a></li>
        <li><a href="#miljø-og-bærekraft">Miljø og bærekraft</a></li>
      </ul>
    </nav>

    <main class="handbook-content">
      <section id="om-kynd">
        <PageSection heading="Om Kynd">
          <Prose align="left">
            <p>
              Kynd er et konsulentbyrå innen fullstack softwareutvikling, organisasjonsdesign og
              smidig produkt-, team og endringsledelse. Vi ble stiftet i 2024 av tre amigos -
              Daniel, Frederik og Axel.
            </p>
            <p>
              Vi er et selskap laget av de ansatte, for de ansatte. Vi ønsker å lage verdens beste
              arbeidsplass, og det gjør vi ved å sette menneskene i fokus.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Grunnverdier</h3>
            <ul>
              <li>Åpenhet</li>
              <li>Samhold</li>
              <li>Enkelhet</li>
              <li>Dristighet</li>
              <li>Relasjonsorientering</li>
            </ul>
          </Prose>
          <Prose align="left">
            <p>
              Kynd er et konsulentbyrå innen fullstack softwareutvikling, organisasjonsdesign og
              smidig produkt-, team og endringsledelse. Vi ble stiftet i 2024 av tre amigos -
              Daniel, Frederik og Axel.
            </p>
            <p>
              Vi er et selskap laget av de ansatte, for de ansatte. Vi ønsker å lage verdens beste
              arbeidsplass, og det gjør vi ved å sette menneskene i fokus.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Grunnverdier</h3>
            <ul>
              <li>Åpenhet</li>
              <li>Samhold</li>
              <li>Enkelhet</li>
              <li>Dristighet</li>
              <li>Relasjonsorientering</li>
            </ul>
          </Prose>
        </PageSection>
      </section>

      <section id="lønn-og-goder">
        <PageSection heading="Lønn og goder">
          <Prose align="left">
            <p>
              Vi har åpen lønn, som vil si at alle i selskapet vet hva de andre tjener. Du slipper
              også å forhandle på lønnen din.
            </p>
            <p>
              Vi oppjusterer lønnen din 1. januar hvert år basert på resultatet til Kynd. Vi passer
              på at lønna holder seg konkurransedyktig og tar også høyde for inflasjon.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Goder</h3>
            <ul>
              <li>Konkurransedyktig lønn</li>
              <li>Åpen økonomi</li>
              <li>Likeverdig eierskap</li>
              <li>Fleksible arbeidsforhold</li>
              <li>Kompetanseutvikling</li>
              <li>Moderne utstyr</li>
            </ul>
          </Prose>
          <Prose align="left">
            <p>
              Vi har åpen lønn, som vil si at alle i selskapet vet hva de andre tjener. Du slipper
              også å forhandle på lønnen din.
            </p>
            <p>
              Vi oppjusterer lønnen din 1. januar hvert år basert på resultatet til Kynd. Vi passer
              på at lønna holder seg konkurransedyktig og tar også høyde for inflasjon.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Goder</h3>
            <ul>
              <li>Konkurransedyktig lønn</li>
              <li>Åpen økonomi</li>
              <li>Likeverdig eierskap</li>
              <li>Fleksible arbeidsforhold</li>
              <li>Kompetanseutvikling</li>
              <li>Moderne utstyr</li>
            </ul>
          </Prose>
        </PageSection>
      </section>

      <section id="arbeidsforhold">
        <PageSection heading="Arbeidsforhold">
          <Prose align="left">
            <p>
              Vi tror på tillit og fleksibilitet. Du kan jobbe der du er mest produktiv, enten det
              er på kontoret eller hjemmefra.
            </p>
            <p>
              Vi har ikke tradisjonelle arbeidstider, men forventer at du leverer kvalitet og er
              tilgjengelig når det trengs.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Arbeidssted</h3>
            <ul>
              <li>Hjemmekontor</li>
              <li>Kontor i Oslo</li>
              <li>Kundens lokaler</li>
              <li>Hybridløsninger</li>
            </ul>
          </Prose>
          <Prose align="left">
            <p>
              Vi tror på tillit og fleksibilitet. Du kan jobbe der du er mest produktiv, enten det
              er på kontoret eller hjemmefra.
            </p>
            <p>
              Vi har ikke tradisjonelle arbeidstider, men forventer at du leverer kvalitet og er
              tilgjengelig når det trengs.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Arbeidssted</h3>
            <ul>
              <li>Hjemmekontor</li>
              <li>Kontor i Oslo</li>
              <li>Kundens lokaler</li>
              <li>Hybridløsninger</li>
            </ul>
          </Prose>
        </PageSection>
      </section>

      <section id="ferie-og-permisjon">
        <PageSection heading="Ferie og permisjon">
          <Prose align="left">
            <p>
              Du har rett på 25 feriedager per år. Vi oppfordrer til å ta ferie, og vi dekker
              feriepenger i henhold til loven.
            </p>
            <p>
              Ved sykdom eller andre behov for fravær, er vi fleksible og forståelsesfulle. Vi tror
              på at hvis vi gir deg tiden du trenger, vil du komme sterkere tilbake.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Permisjon</h3>
            <ul>
              <li>25 feriedager</li>
              <li>Feriepenger</li>
              <li>Sykefravær</li>
              <li>Foreldrepermisjon</li>
              <li>Utdanningspermisjon</li>
            </ul>
          </Prose>
          <Prose align="left">
            <p>
              Du har rett på 25 feriedager per år. Vi oppfordrer til å ta ferie, og vi dekker
              feriepenger i henhold til loven.
            </p>
            <p>
              Ved sykdom eller andre behov for fravær, er vi fleksible og forståelsesfulle. Vi tror
              på at hvis vi gir deg tiden du trenger, vil du komme sterkere tilbake.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Permisjon</h3>
            <ul>
              <li>25 feriedager</li>
              <li>Feriepenger</li>
              <li>Sykefravær</li>
              <li>Foreldrepermisjon</li>
              <li>Utdanningspermisjon</li>
            </ul>
          </Prose>
        </PageSection>
      </section>

      <section id="kompetanseutvikling">
        <PageSection heading="Kompetanseutvikling">
          <Prose align="left">
            <p>
              Vi investerer tungt i kompetanseutvikling. Du får tid og ressurser til å lære nye
              teknologier og metoder.
            </p>
            <p>
              Vi deler kunnskap aktivt gjennom interne presentasjoner, workshops og konferansebesøk.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Muligheter</h3>
            <ul>
              <li>Konferansebesøk</li>
              <li>Kurs og sertifiseringer</li>
              <li>Interne workshops</li>
              <li>Mentoring</li>
              <li>Open source bidrag</li>
            </ul>
          </Prose>
          <Prose align="left">
            <p>
              Vi investerer tungt i kompetanseutvikling. Du får tid og ressurser til å lære nye
              teknologier og metoder.
            </p>
            <p>
              Vi deler kunnskap aktivt gjennom interne presentasjoner, workshops og konferansebesøk.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Muligheter</h3>
            <ul>
              <li>Konferansebesøk</li>
              <li>Kurs og sertifiseringer</li>
              <li>Interne workshops</li>
              <li>Mentoring</li>
              <li>Open source bidrag</li>
            </ul>
          </Prose>
        </PageSection>
      </section>

      <section id="miljø-og-bærekraft">
        <PageSection heading="Miljø og bærekraft">
          <Prose align="left">
            <p>
              Som selskap ønsker vi å ta ansvar og gjøre vår del for å begrense belastningen på
              miljøet og bli mer bærekraftige.
            </p>
            <p>
              Vi jobber aktivt med å redusere vår klimafotavtrykk og støtter bærekraftige løsninger
              i våre prosjekter.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Tiltak</h3>
            <ul>
              <li>Grønn teknologi</li>
              <li>Remote-first arbeid</li>
              <li>Bærekraftige leverandører</li>
              <li>Miljøvennlige kontorer</li>
              <li>Klimakompensasjon</li>
            </ul>
          </Prose>
          <Prose align="left">
            <p>
              Som selskap ønsker vi å ta ansvar og gjøre vår del for å begrense belastningen på
              miljøet og bli mer bærekraftige.
            </p>
            <p>
              Vi jobber aktivt med å redusere vår klimafotavtrykk og støtter bærekraftige løsninger
              i våre prosjekter.
            </p>
          </Prose>
          <Prose align="right">
            <h3>Tiltak</h3>
            <ul>
              <li>Grønn teknologi</li>
              <li>Remote-first arbeid</li>
              <li>Bærekraftige leverandører</li>
              <li>Miljøvennlige kontorer</li>
              <li>Klimakompensasjon</li>
            </ul>
          </Prose>
        </PageSection>
      </section>
    </main>
  </div>
</Layout>

<style>
  /* CSS Variables for Handbook */
  :root {
    --handbook-header-height: 4rem;
    --handbook-nav-height: 3rem;
    --handbook-nav-padding: 1rem;
    --handbook-z-index-nav: 3;
    --handbook-z-index-dropdown: 4;
    --handbook-z-index-toggle: 10;
    --handbook-transition-fast: background-color 0.2s ease;
    --handbook-transition-smooth: transform 0.3s ease;
  }

  /* Mobile sticky navigation */
  .mobile-nav {
    display: block;
    position: sticky;
    top: var(--handbook-header-height);
    left: 0;
    right: 0;
    background-color: var(--color-background);
    border-bottom: 1px solid var(--color-border);
    z-index: var(--handbook-z-index-nav);
    padding: 0.5rem var(--content-padding);

    @media (--md) {
      display: none;
    }
  }

  .mobile-nav-content {
    display: flex;
    align-items: center;
    max-width: var(--content-max-width);
    margin: 0 auto;
    position: relative;
    gap: 0.5rem;
  }

  .nav-title {
    font-size: var(--fs-body-s);
    font-weight: 600;
    margin: 0;
    color: var(--color-text);
  }

  .handbook-menu-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0;
    z-index: var(--handbook-z-index-toggle);

    .triangle-icon {
      font-size: 0.875rem;
      color: var(--color-text);
      transition: var(--handbook-transition-smooth);
      transform-origin: center;
    }

    &[aria-expanded='true'] {
      .triangle-icon {
        transform: rotate(90deg);
      }
    }
  }

  /* Dropdown menu */
  .handbook-dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: var(--color-background);
    border: 1px solid var(--color-border);
    border-top: none;
    z-index: var(--handbook-z-index-dropdown);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);

    &.open {
      display: block;
    }
  }

  /* Desktop navigation */
  .handbook-container {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    max-width: var(--content-max-width);
    margin: 0 auto;
    padding: 0 var(--content-padding);

    @media (--md) {
      grid-template-columns: 250px 1fr;
      gap: 4rem;
    }
  }

  .desktop-nav {
    display: none;
    position: sticky;
    top: calc(var(--handbook-header-height) + var(--handbook-nav-padding));
    height: fit-content;
    background-color: var(--color-background);
    padding: var(--handbook-nav-padding) 0;
    border-right: 1px solid var(--color-border);

    @media (--md) {
      display: block;
    }
  }

  .nav-menu {
    list-style: none;
    padding: 0;
    margin: 0;

    li {
      margin-bottom: 0;
    }

    a {
      display: block;
      padding: 0.75rem var(--content-padding);
      text-decoration: none;
      color: var(--color-text);
      font-size: var(--fs-body-s);
      transition: var(--handbook-transition-fast);

      &:hover,
      &.active {
        background-color: var(--color-accent);
      }

      &:focus {
        outline: 2px solid var(--color-accent);
        outline-offset: 2px;
      }

      &.active {
        font-weight: 600;
      }
    }
  }

  .handbook-content {
    padding-top: 0; /* No extra padding needed since nav is now sticky */

    @media (--md) {
      padding-top: 0;
    }
  }

  /* Smooth scrolling for anchor links */
  html {
    scroll-behavior: smooth;
  }

  /* Offset for sticky header */
  .handbook-content section[id] {
    scroll-margin-top: calc(
      var(--handbook-header-height) + var(--handbook-nav-height) + var(--handbook-nav-padding)
    );

    @media (--md) {
      scroll-margin-top: calc(var(--handbook-header-height) + 2rem);
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const handbookMenuToggle = document.getElementById('handbook-menu-toggle');
    const handbookDropdown = document.getElementById('handbook-dropdown');
    const currentSection = document.getElementById('current-section');
    const navLinks = document.querySelectorAll('.nav-menu a');


    // Section data for tracking
    const sections = [
      { id: 'om-kynd', title: 'Om Kynd' },
      { id: 'lønn-og-goder', title: 'Lønn og goder' },
      { id: 'arbeidsforhold', title: 'Arbeidsforhold' },
      { id: 'ferie-og-permisjon', title: 'Ferie og permisjon' },
      { id: 'kompetanseutvikling', title: 'Kompetanseutvikling' },
      { id: 'miljø-og-bærekraft', title: 'Miljø og bærekraft' },
      { id: 'miljø-og-bærekraft', title: 'Miljø og bærekraft' },
    ];

    // Toggle dropdown menu
    function toggleDropdown() {
      if (handbookMenuToggle && handbookDropdown) {
        const isExpanded = handbookMenuToggle.getAttribute('aria-expanded') === 'true';

        if (isExpanded) {
          handbookMenuToggle.setAttribute('aria-expanded', 'false');
          handbookDropdown.classList.remove('open');
        } else {
          handbookMenuToggle.setAttribute('aria-expanded', 'true');
          handbookDropdown.classList.add('open');
        }
      }
    }

    // Close dropdown menu
    function closeDropdown() {
      if (handbookMenuToggle && handbookDropdown) {
        handbookMenuToggle.setAttribute('aria-expanded', 'false');
        handbookDropdown.classList.remove('open');
      }
    }

    // Update current section based on scroll position
    function updateCurrentSection() {
      if (!currentSection) return;

      const scrollPosition = window.scrollY + 200; // Offset for better detection


      for (let i = sections.length - 1; i >= 0; i--) {
        const section = sections[i];
        if (!section) continue;


        const sectionElement = document.getElementById(section.id);
        if (sectionElement) {
          const elementTop = sectionElement.offsetTop;
          if (elementTop <= scrollPosition) {
            currentSection.textContent = section.title;
            updateActiveLink(section.id);
            break;
          }
        }
      }
    }

    // Update active link in navigation
    function updateActiveLink(activeId: string) {
      navLinks.forEach((link) => {
      navLinks.forEach((link) => {
        link.classList.remove('active');
        if (link.getAttribute('href') === `#${activeId}`) {
          link.classList.add('active');
        }
      });
    }

    // Event listeners
    if (handbookMenuToggle) {
      handbookMenuToggle.addEventListener('click', toggleDropdown);
    }

    // Close dropdown when clicking on navigation links
    navLinks.forEach((link) => {
      link.addEventListener('click', function () {
        if (window.matchMedia('(max-width: 47.999em)').matches) {
          closeDropdown();
        }
      });
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', function (event) {
      if (handbookDropdown && handbookMenuToggle && event.target) {
        const target = event.target as Node;
        const isClickInsideDropdown = handbookDropdown.contains(target);
        const isClickOnToggle = handbookMenuToggle.contains(target);

        if (
          !isClickInsideDropdown &&
          !isClickOnToggle &&
          handbookDropdown.classList.contains('open')
        ) {
          closeDropdown();
        }
      }
    });

    // Scroll tracking
    let ticking = false;
    function handleScroll() {
      if (!ticking) {
        requestAnimationFrame(function () {
        requestAnimationFrame(function () {
          updateCurrentSection();
          ticking = false;
        });
        ticking = true;
      }
    }

    window.addEventListener('scroll', handleScroll);


    // Initial call to set current section
    updateCurrentSection();

    // Handle window resize
    window.addEventListener('resize', function () {
      if (window.matchMedia('(min-width: 48em)').matches) {
        closeDropdown();
      }
    });
  });
</script>
